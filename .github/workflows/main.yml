name: Plugin Build - Basic PowerShell Debug
on:
  push:
    paths-ignore:
      - '**.md'
    branches:
      - master
      - main

env:
  PLUGIN_NAME: 'obs-multistream'

jobs:
  format_check:
    name: 01 - Format Check (Bypassed)
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Skip Format Check
        run: |
          echo "‚úÖ Format check bypassed for debugging"
          ls -la src/ || echo "No src directory"

  windows_basic:
    name: 02 - Windows Basic PowerShell Test
    runs-on: windows-2022
    if: always()
    defaults:
      run:
        shell: pwsh
    steps:
      - name: Test 1 - Basic Echo
        run: |
          Write-Host "=== Test 1: Basic Echo ===" -ForegroundColor Green
          Write-Host "This is a basic echo test" -ForegroundColor Yellow
          Write-Host "‚úÖ Basic echo successful" -ForegroundColor Green

      - name: Test 2 - PowerShell Version
        run: |
          Write-Host "=== Test 2: PowerShell Version ===" -ForegroundColor Green
          $PSVersionTable
          Write-Host "‚úÖ PowerShell version check successful" -ForegroundColor Green

      - name: Test 3 - Simple Command
        run: |
          Write-Host "=== Test 3: Simple Command ===" -ForegroundColor Green
          $location = Get-Location
          Write-Host "Current location: $location" -ForegroundColor Yellow
          Write-Host "‚úÖ Simple command successful" -ForegroundColor Green

      - name: Test 4 - Exit Code Handling
        run: |
          Write-Host "=== Test 4: Exit Code Handling ===" -ForegroundColor Green
          # Test proper exit code propagation
          $result = $true
          if ($result) {
            Write-Host "‚úÖ Exit code test successful" -ForegroundColor Green
            exit 0
          } else {
            Write-Host "‚ùå Exit code test failed" -ForegroundColor Red
            exit 1
          }

  windows_skip_advanced:
    name: 03 - Skip Advanced Tests (Debug Mode)
    runs-on: ubuntu-22.04
    if: always()
    needs: [windows_basic]
    steps:
      - name: Debug Mode Notice
        run: |
          echo "üîß Debug mode active - advanced tests skipped"
          echo "Basic PowerShell tests should pass first" 